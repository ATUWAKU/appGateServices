pipeline {
    agent any
	triggers {
	  upstream 'appGateServices_CI'	
	}	
    stages {
        stage('Ejecucion') {
            steps {                
				bat 'gradlew clean build test aggregate'
            }
        }
		stage('Email') {
			steps {
				script {
					def mailRecipients = 'david_muner@hotmail.com'
					def jobName = currentBuild.fullDisplayName
					emailext body: '''${SCRIPT, template="groovy-html.template"}''',
					mimeType: 'text/html',
					subject: "[Jenkins] ${jobName}",
					to: "${mailRecipients}",
					replyTo: "${mailRecipients}",
					recipientProviders: [[$class: 'CulpritsRecipientProvider']]
				}
			}
		}		
    }
}
